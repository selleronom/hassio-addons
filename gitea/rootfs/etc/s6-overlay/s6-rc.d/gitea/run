#!/command/with-contenv bashio
# shellcheck shell=bash

bashio::log.info "Starting Gitea..."

export GITEA_WORK_DIR=/data/gitea
export HOME=/data/gitea

cd /data/gitea
chown -R git:git /data/gitea

DISABLE_REGISTRATION=$(bashio::config 'disable_registration')
REQUIRE_SIGNIN_VIEW=$(bashio::config 'require_signin_view')

export GITEA__service__DISABLE_REGISTRATION=${DISABLE_REGISTRATION}
export GITEA__service__REQUIRE_SIGNIN_VIEW=${REQUIRE_SIGNIN_VIEW}

exec s6-setuidgid git gitea web --config /data/gitea/custom/conf/app.ini
